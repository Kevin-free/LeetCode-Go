今天是 Kevin 的算法之路的第 53 天。为大家讲解 LeetCode 第 1541 题，是一道抓住括号不放的题目。



## 每日一笑

> 刚刚跟朋友玩打手背游戏，不小心抓到了她的手，然后她拿出手机在网上搜索，被单手狗抓了需要打狂犬疫苗吗。



## 题目描述

> 给你一个括号字符串 s ，它只包含字符 '(' 和 ')' 。一个括号字符串被称为平衡的当它满足：
>
> 任何左括号 '(' 必须对应两个连续的右括号 '))' 。
> 左括号 '(' 必须在对应的连续两个右括号 '))' 之前。
> 比方说 "())"， "())(())))" 和 "(())())))" 都是平衡的， ")()"， "()))" 和 "(()))" 都是不平衡的。
>
> 你可以在任意位置插入字符 '(' 和 ')' 使字符串平衡。
>
> 请你返回让 s 平衡的最少插入次数。
>
>  
>
> 示例 1：
>
> 输入：s = "(()))"
> 输出：1
> 解释：第二个左括号有与之匹配的两个右括号，但是第一个左括号只有一个右括号。我们需要在字符串结尾额外增加一个 ')' 使字符串变成平衡字符串 "(())))" 。
> 示例 2：
>
> 输入：s = "())"
> 输出：0
> 解释：字符串已经平衡了。
> 示例 3：
>
> 输入：s = "))())("
> 输出：3
> 解释：添加 '(' 去匹配最开头的 '))' ，然后添加 '))' 去匹配最后一个 '(' 。
> 示例 4：
>
> 输入：s = "(((((("
> 输出：12
> 解释：添加 12 个 ')' 得到平衡字符串。
> 示例 5：
>
> 输入：s = ")))))))"
> 输出：5
> 解释：在字符串开头添加 4 个 '(' 并在结尾添加 1 个 ')' ，字符串变成平衡字符串 "(((())))))))" 。
>
>
> 提示：
>
> 1 <= s.length <= 10^5
> s 只包含 '(' 和 ')' 。
>
> 来源：力扣（LeetCode）
> 链接：https://leetcode-cn.com/problems/minimum-insertions-to-balance-a-parentheses-string
> 著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。



## 解题思路

这道题的不同之处在于 一个左括号 `（` 匹配两个右括号 `）`，我们可以遍历字符串，用一个 `count` 当作栈用于记录左括号的数量，难点在于判断右括号的情况：

- 遇到两个右括号时：
  - 判断栈中，有左括号消费左括号；
  - 没有左括号，要插入一个左括号；
- 遇到一个右括号时：
  - 判断栈中，有左括号消费左括号；
  - 没有左括号，要插入一个左括号和一个右括号；



## 代码实现

```go
//go
func minInsertions(s string) int {
	n := len(s) // 字符串长度
	count := 0  // 左括号数量
	ret := 0    // 返回结果

	i := 0
	// 遍历字符串
	for i < n {
		// 如果是左括号，count+1记录为栈
		if s[i] == '(' {
			count++
			i++
		} else {
			// 判断右括号
			// 如果连续两个右括号
			if i+1 < n && s[i+1] == ')' {
				// 判断栈中有无左括号
				if count > 0 {
					// 有，消费一个左括号
					count--
				} else {
					ret++ // 无，补一个左括号
				}
				i += 2 // 两个右括号，前进两部
			} else if i < n && s[i] == ')' {
				// 判断栈中有无左括号
				if count > 0 {
					// 有，消费一个左括号
					count--
					ret += 1 // 添一个右括号
				} else {
					ret += 2 // 添一个左括号和一个右括号
				}
				i++ // 一个右括号，前进一部
			}
		}
	}
	ret += count * 2 // 返回结果= ret + 有左括号的数*2

	return ret
}
```



```java
//java
class Solution {
    public int minInsertions(String s) {
        int insertions = 0;
        int leftCount = 0;
        int length = s.length();
        int index = 0;
        while (index < length) {
            char c = s.charAt(index);
            if (c == '(') {
                leftCount++;
                index++;
            } else {
                if (leftCount > 0) {
                    leftCount--;
                } else {
                    insertions++;
                }
                if (index < length - 1 && s.charAt(index + 1) == ')') {
                    index += 2;
                } else {
                    insertions++;
                    index++;
                }
            }
        }
        insertions += leftCount * 2;
        return insertions;
    }
}
```



> 郑重声明：
>
> 所展示代码已通过 LeetCode 运行通过，请放心食用～



## 在唠唠嗑

> 很多人都想养成好习惯，但大多数人却是三分钟热度。为了我们能一起坚持下去，决定制定如下计划（福利）
>
> **一起学算法，打卡领红包！**
>
> 参与方式：
>
> 关注我的**微信公众号「Kevin的学堂」**
>
> 还可「**加群**」与众多小伙伴
>
> 一起坚持，一起学习，一起更优秀！
>
> 打卡规则为：
>
> **「留言」“打卡XXX天” ➕「分享」到朋友圈**
>
> 奖励：
>
> 打卡 **`21`** 天，联系本人获取 **`6.6`** 元红包一个！
>
> 打卡 **`52`** 天，联系本人获取 **`16.6`** 元红包一个！
>
> 打卡 **`100`** 天，联系本人获取 **`66.6`** 元红包一个！



![长按扫码，一起进步](http://wesub.ifree258.top/wesubQRCode-2.png)